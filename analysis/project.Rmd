---
title: "Alcohol Consumption Patterns"
output:
  flexdashboard::flex_dashboard:
    theme: bootstrap
    orientation: columns
    vertical_layout: scroll
---
   

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(knitr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(maps)
library(plotly)
library(flexdashboard)
library(kableExtra)
library(rnaturalearth)
library(RColorBrewer)
library(sf)
library(viridis)
```

Introduction {.tabset}
======================

Column {.tabset} {data-width=650}
-------------------------------------

### Background




Column {.tabset} {data-width=200}
-------------------------------------

### Approach of Project

The report will be collating specific sections of this data pertaining to countrywise policy responses, consumption pattern, youth and alcohol, levels of consumption and harms and consequences.

### Information on Data

This report is being created using the data from the GISAH (Global Information System on Alcohol and Health) tool of the World Health Organisation. GISAH tool helps monitor trends relating to alcohol consumption across various age groups, side effects (harm caused) as well as the policy responses by different countries.

### Makers

**Team Name: Hayaku**

_Researchers:_

- _Kexin Xu_
- _Smriti Vinayak Bhat_
- _Yalong liu_
- _Yin Shan Ho_


Popularity {.tabset} 
======================


Cause of Mortality {.tabset} 
======================

Column {.tabset} {data-width=650}
-------------------------------------

```{r}
alcohol_cancer <- read.csv("../clean_data/cancer_a_clean.csv")
alcohol_liver <- read.csv("../clean_data/liver_a_clean.csv")
alcohol_traffic <- read.csv("../clean_data/traffic_a_clean.csv")
death_cancer <- read.csv("../clean_data/cancer_d_clean.csv")
death_liver <- read.csv("../clean_data/liver_d_clean.csv")
death_traffic <- read.csv("../clean_data/traffic_d_clean.csv")

alc_cancer_death <- death_cancer %>%
  left_join(alcohol_cancer) %>% 
  mutate(can_alc_death = `cancer.death.population` * `alc.attri.death.cancer`/100) %>% 
  select(Country, gender, can_alc_death)
  
alc_liver_death <- death_liver %>%
  left_join(alcohol_liver) %>% 
  mutate(liver_alc_death = `liver.cirrhosis.death.population` * `alc.attri.death.liver`/100) %>% 
    select(Country, gender, liver_alc_death)

alc_traffic_death <- death_traffic %>%
  left_join(alcohol_traffic) %>% 
  mutate(`alc.attri.death.traffic` = as.numeric(`alc.attri.death.traffic`)) %>% 
    mutate(traffic_alc_death = `road.traffic.death.population` * `alc.attri.death.traffic`/100) %>% 
  select(Country, gender, traffic_alc_death)    

 alc_death <- alc_cancer_death %>% 
  left_join(alc_liver_death) %>% 
  left_join(alc_traffic_death) %>% 
  pivot_longer(cols = c("can_alc_death", "liver_alc_death", "traffic_alc_death"),
               names_to = "cause_of_death",
               values_to = "number_of_death") 

```

### Overview on the alcohol-attributed death

```{r}

countries <- ne_countries(returnclass = "sf", scale = "medium") %>%
  select(admin, continent, income_grp)

 alc_death_sum <- alc_death %>% 
   group_by(Country) %>% 
   summarise(number_of_death = sum(number_of_death))

map_all <- alc_death_sum %>%
  mutate(Country = recode(Country,
                             "Bahamas" = "The Bahamas",
                             "Bolivia (Plurinational State of)" = "Bolivia",
                             "Brunei Darussalam" = "Brunei",
                             "Cabo Verde" = "Cape Verde",
                             "Congo" = "Democratic Republic of the Congo",
                             "Czechia" = "Czech Republic",
                             "Democratic People's Republic of Korea" = "North Korea",
                             "Guinea-Bissau" = "Guinea Bissau",
                             "Iran (Islamic Republic of)" = "Iran",
                             "Lao People's Democratic Republic" = "Laos",
                             "Micronesia (Federated States of)" = "Federated States of Micronesia",
                             "North Macedonia" = "Macedonia",
                             "Republic of Korea" = "South Korea",
                             "Republic of Moldova" = "Moldova",
                             "Russian Federation" = "Russia",
                             "Serbia" = "Republic of Serbia",
                             "Syrian Arab Republic" = "Syria",
                             "Timor-Leste" = "East Timor",
                             "Tuvalu" = "Wallis and Futuna",
                             "United Kingdom of Great Britain and Northern Ireland" = "United Kingdom", 
                             "Venezuela (Bolivarian Republic of)" = "Venezuela",
                             "Viet Nam" = "Vietnam")) 

all_loc <-left_join(countries, map_all, by = c("admin" = "Country"))

p1 <- all_loc %>% 
      ggplot()+
  geom_sf(mapping = aes(fill = number_of_death))+
  scale_fill_distiller(palette = "Spectral", na.value = "white", )+
  labs(title = "Overview of alcohol-attributed deaths",
       fill = "") +
  theme_void()+
  theme(panel.grid.major = element_line(colour = "transparent"),
        legend.position = "bottom")

ggplotly(p1)

```

### Comparison between alcohol-attributed deaths

**Calculation Method:**

- Cancer Death $\times$ Alcohol-Attributed Cancer Death Rate

- Liver Cirrhosis Death $\times$ Alcohol-attributed Liver Cirrhosis Death Rate

- Road Traffic Death $\times$ Alcohol-attributed Road Traffic Death Rate


**Analysis:**

- Alcohol causes more deaths to *Males*.

- *Liver Cirrhosis* causes the highest death rate while *Road Traffic Accidents* causes the lowest.

- Alcohol causes the highest death rate in *Nigeria* and the lowest in *Lybia*.

- Alcohol brings the highest number of deaths in Africa.

**Possible reasons affecting death rates**

- Religions

- Income

- Education

- Medical conditions



Column {.tabset} {data-width=350}
-------------------------------------

```{r eval = FALSE}
countries <- ne_countries(returnclass = "sf", scale = "medium") %>%
  select(admin, continent, income_grp)

alc_death %>%
  left_join(countries, by = c("Country" = "admin")) %>% 
  group_by(Country, continent, gender) %>% 
  summarise(alc_death = sum(number_of_death)) %>% 
  left_join(death_traffic) %>% 
  drop_na() %>% 
  rename("traffic_death" = `road.traffic.death.population`) %>% 
    group_by(continent) %>% 
  summarise(alc_death = mean(alc_death),
            traffic_death = mean(traffic_death))%>%    
  arrange(desc(alc_death)) %>%
  kable(align = "c") %>% 
  kable_styling("striped","hover")

```

### Total number of alcohol attributed death

```{r fig.height=4 ,fig.width=2}

overview <- alc_death %>% 
  group_by(gender, cause_of_death) %>%  
  ggplot(aes(x = cause_of_death,
             y = number_of_death,
             fill = gender))+
    geom_col(position = "dodge")+
    theme_bw() 
ggplotly(overview)

```

### Alcohol-Attributed Death VS Road Traffic death (By Income Level)

```{r }

alc_death %>%
  left_join(countries, by = c("Country" = "admin")) %>% 
  mutate(income_grp = recode(income_grp,
                            `2. High income: nonOECD` = "high",
                            `5. Low income` = "low",
                            `3. Upper middle income` =  "upper_middle",
                            `4. Lower middle income` =  "lower_middle",
                            `1. High income: OECD` = "high")) %>%
  group_by(Country, income_grp, gender) %>%
  summarise(alc_death = sum(number_of_death)) %>% 
  left_join(death_traffic) %>% 
  drop_na() %>% 
  rename("traffic_death" = `road.traffic.death.population`) %>% 
    group_by(income_grp) %>% 
  summarise(alc_death = mean(alc_death),
            traffic_death = mean(traffic_death))%>%    
  arrange(desc(alc_death)) %>%
  kable(align = "c") %>% 
  kable_styling("striped","hover")
  
```

### Comparison between total alcohol-attributed deaths and traffic deaths

**Harms of alcohol**

- Cancer

- Liver Cirrhosis

- Road traffic accidents

**Calculation method: **

- Average number of deaths(per 100,000 population) in each continent.


**Analysis:**

- Alcohol causes more deaths to *Males*.

- *Liver Cirrhosis* causes the highest death rate while *Road Traffic Accidents* causes the lowest.


Policy Pattern {.tabset}
======================

```{r read_data}
policy_pattern <- read_csv("../clean_data/policy_pattern.csv")
consumption_pattern <- read_csv("../clean_data/consumption_pattern.csv")
```

```{r}

policy_country_group <- policy_pattern %>%
  pivot_longer(cols = c("2010", "2011", "2012", "2013", "2014","2015", "2016"),
               names_to = "Year",
               values_to = "Action")

policy_country_group_plot <-  policy_country_group %>%
  group_by(`Action Area`,Year) %>%
  tally() %>%
  arrange(Year)

policy_country_group_2010 <- policy_pattern %>%
  select(Country, `Action Area`, "2010") %>%
  na.omit()

policy_country_group_2011 <- policy_pattern %>%
  select(Country, `Action Area`, "2011") %>%
  na.omit()

policy_country_group_2012 <- policy_pattern %>%
  select(Country, `Action Area`, "2012") %>%
  na.omit()

policy_country_group_2013 <- policy_pattern %>%
  select(Country, `Action Area`, "2013") %>%
  na.omit()

policy_country_group_2014 <- policy_pattern %>%
  select(Country, `Action Area`, "2014") %>%
  na.omit()

policy_country_group_2015 <- policy_pattern %>%
  select(Country, `Action Area`, "2015") %>%
  na.omit()

policy_country_group_2016 <- policy_pattern %>%
  select(Country, `Action Area`, "2016") %>%
  na.omit()
```


Age Restrictions {.tabset}
======================



Youth Inebriation {.tabset}
======================


Limitations {.tabset}
======================


References {.tabset}
======================

GHO | global information system on alcohol and Health (gisah) | global information system on alcohol and health. (n.d.). Retrieved May 09, 2021, from https://apps.who.int/gho/data/node.gisah.GISAH?lang=en&amp;showonly=GISAH