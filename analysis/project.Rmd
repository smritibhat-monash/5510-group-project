---
title: "Alcohol Consumption Patterns"
output:
  flexdashboard::flex_dashboard:
    theme: bootstrap
    orientation: columns
    vertical_layout: scroll
---
   

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(knitr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(maps)
library(plotly)
library(flexdashboard)
library(kableExtra)
```

Introduction {.tabset}
======================

Column {.tabset} {data-width=650}
-------------------------------------

### Background




Column {.tabset} {data-width=200}
-------------------------------------

### Approach of Project

The report will be collating specific sections of this data pertaining to countrywise policy responses, consumption pattern, youth and alcohol, levels of consumption and harms and consequences.

### Information on Data

This report is being created using the data from the GISAH (Global Information System on Alcohol and Health) tool of the World Health Organisation. GISAH tool helps monitor trends relating to alcohol consumption across various age groups, side effects (harm caused) as well as the policy responses by different countries.

### Makers

**Team Name: Hayaku**

_Researchers:_

- _Kexin Xu_
- _Smriti Vinayak Bhat_
- _Yalong liu_
- _Yin Shan Ho_


Popularity {.tabset} 
======================


Cause of Mortality {.tabset} 
======================

Column {.tabset} {data-width=650}
-------------------------------------

```{r}
alcohol_cancer <- read.csv("../clean_data/cancer_a_clean.csv")
alcohol_liver <- read.csv("../clean_data/liver_a_clean.csv")
alcohol_traffic <- read.csv("../clean_data/traffic_a_clean.csv")
death_cancer <- read.csv("../clean_data/cancer_d_clean.csv")
death_liver <- read.csv("../clean_data/liver_d_clean.csv")
death_traffic <- read.csv("../clean_data/traffic_d_clean.csv")

alc_cancer_death <- death_cancer %>%
  left_join(alcohol_cancer) %>% 
  mutate(can_alc_death = `cancer.death.population` * `alc.attri.death.cancer`/100) %>% 
  select(Country, gender, can_alc_death)
  
alc_liver_death <- death_liver %>%
  left_join(alcohol_liver) %>% 
  mutate(liver_alc_death = `liver.cirrhosis.death.population` * `alc.attri.death.liver`/100) %>% 
    select(Country, gender, liver_alc_death)

alc_traffic_death <- death_traffic %>%
  left_join(alcohol_traffic) %>% 
  mutate(`alc.attri.death.traffic` = as.numeric(`alc.attri.death.traffic`)) %>% 
    mutate(traffic_alc_death = `road.traffic.death.population` * `alc.attri.death.traffic`/100) %>% 
  select(Country, gender, traffic_alc_death)    

alc_illness_death <- alc_cancer_death %>% 
  left_join(alc_liver_death) %>% 
  mutate(illness_alc_death = can_alc_death + liver_alc_death) %>% 
    select(Country, gender, illness_alc_death) 

alc_death <- alc_illness_death %>% 
  left_join(alc_traffic_death) %>% 
  pivot_longer(cols = c("illness_alc_death", "traffic_alc_death"),
               names_to = "cause_of_death",
               values_to = "number_of_death") 
```

### Total number of alcohol attributed death

```{r fig.height=4 ,fig.width=2}
overview <- alc_death %>% 
  group_by(gender, cause_of_death) %>%  
  ggplot(aes(x = cause_of_death,
             y = number_of_death,
             fill = gender))+
    geom_col(position = "dodge")+
    theme_bw() 
ggplotly(overview)

```

### Overview on the alcohol-attributed death

```{r fig.height=10}

view_by_country <- alc_death %>% 
  select(Country, cause_of_death, number_of_death,gender)%>% 
  group_by(Country,cause_of_death) %>% 
  ggplot(aes(x = reorder(Country,desc(number_of_death)),
             y = number_of_death,
             fill = gender))+
    geom_bar(stat="identity")+
    facet_wrap(~cause_of_death, ncol =1)+
    theme_bw()+
   theme(axis.text.x = element_text(angle = 90, vjust = 0.3)) 

ggplotly(view_by_country)

```

```{r}
alc_death %>% 
  group_by(Country, gender) %>% 
  summarise(number_of_alc_death = sum(number_of_death))%>% 
  left_join(death_traffic) %>% 
  left_join(death_cancer) %>% 
  arrange(desc(number_of_alc_death)) %>% 
  kable()
  
  pivot_longer(cols = c("number_of_alc_death", `road.traffic.death.population`),
               names_to = "cause_of_death",
               values_to = "number_of_death") %>% 
  ggplot(aes(x = reorder(Country, desc(number_of_death)),
             y = number_of_death, 
             fill = gender)) +
  geom_bar(stat="identity")+
    facet_wrap(~cause_of_death, ncol =1)+
    theme_bw()+
   theme(axis.text.x = element_text(angle = 90, vjust = 0.3)) 
```


Column {.tabset} {data-width=350}
-------------------------------------
### Top 20 Countries

```{r}
alc_death %>% 

  select(Country, cause_of_death, gender, number_of_death)%>%
  group_by(Country,cause_of_death) %>% 
  arrange(desc(number_of_death)) %>% 
  head(20) %>% 
  kable() %>% 
  kable_styling("striped","hover")
```

Policy Pattern {.tabset}
======================

```{r read_data}
policy_pattern <- read_csv("../clean_data/policy_pattern.csv")
consumption_pattern <- read_csv("../clean_data/consumption_pattern.csv")
```

```{r}

policy_country_group <- policy_pattern %>%
  pivot_longer(cols = c("2010", "2011", "2012", "2013", "2014","2015", "2016"),
               names_to = "Year",
               values_to = "Action")

policy_country_group_plot <-  policy_country_group %>%
  group_by(`Action Area`,Year) %>%
  tally() %>%
  arrange(Year)

policy_country_group_2010 <- policy_pattern %>%
  select(Country, `Action Area`, "2010") %>%
  na.omit()

policy_country_group_2011 <- policy_pattern %>%
  select(Country, `Action Area`, "2011") %>%
  na.omit()

policy_country_group_2012 <- policy_pattern %>%
  select(Country, `Action Area`, "2012") %>%
  na.omit()

policy_country_group_2013 <- policy_pattern %>%
  select(Country, `Action Area`, "2013") %>%
  na.omit()

policy_country_group_2014 <- policy_pattern %>%
  select(Country, `Action Area`, "2014") %>%
  na.omit()

policy_country_group_2015 <- policy_pattern %>%
  select(Country, `Action Area`, "2015") %>%
  na.omit()

policy_country_group_2016 <- policy_pattern %>%
  select(Country, `Action Area`, "2016") %>%
  na.omit()
```


Age Restrictions {.tabset}
======================



Youth Inebriation {.tabset}
======================


Limitations {.tabset}
======================


References {.tabset}
======================

GHO | global information system on alcohol and Health (gisah) | global information system on alcohol and health. (n.d.). Retrieved May 09, 2021, from https://apps.who.int/gho/data/node.gisah.GISAH?lang=en&amp;showonly=GISAH